<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alex Johnstone">
<meta name="dcterms.date" content="2023-08-22">

<title>QO-100 Build: Part 1 ‚Äì The Design ‚Äì üìª GM5ALX Radio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="QO-100 Build: Part 1 ‚Äì The Design ‚Äì üìª GM5ALX Radio">
<meta property="og:description" content="Figuring out the shopping list">
<meta property="og:image" content="https://gm5alx.uk/posts/2023/qo-100-build-part-1-the-design/eshail-2-qatar-oscar-100.png">
<meta property="og:site_name" content="üìª GM5ALX Radio">
<meta property="og:image:height" content="641">
<meta property="og:image:width" content="1140">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">üìª GM5ALX Radio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../sota.html"> 
<span class="menu-text">SOTA Activations</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../../../index.xml"> <i class="bi bi-rss-fill" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#my-plans" id="toc-my-plans" class="nav-link active" data-scroll-target="#my-plans">My Plans</a>
  <ul class="collapse">
  <li><a href="#the-receive" id="toc-the-receive" class="nav-link" data-scroll-target="#the-receive">The Receive</a></li>
  <li><a href="#pluto-sdr" id="toc-pluto-sdr" class="nav-link" data-scroll-target="#pluto-sdr">Pluto+ SDR</a></li>
  <li><a href="#the-transmit" id="toc-the-transmit" class="nav-link" data-scroll-target="#the-transmit">The Transmit</a></li>
  <li><a href="#power" id="toc-power" class="nav-link" data-scroll-target="#power">Power</a></li>
  <li><a href="#cost" id="toc-cost" class="nav-link" data-scroll-target="#cost">Cost</a></li>
  <li><a href="#and-finally" id="toc-and-finally" class="nav-link" data-scroll-target="#and-finally">and finally‚Ä¶</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/alexjj/gm5alx/blob/main/posts/2023/qo-100-build-part-1-the-design/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">QO-100 Build: Part 1 ‚Äì The Design</h1>
<p class="subtitle lead">Figuring out the shopping list</p>
  <div class="quarto-categories">
    <div class="quarto-category">QO-100</div>
    <div class="quarto-category">satellites</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Alex Johnstone </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 22, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>I think I first heard about QO-100 when looking at a <a href="https://www.qrz.com/db/GM0NRT">local amateur‚Äôs QRZ page</a>. He‚Äôd setup a couple of satellite dishes in his garden and had his <a href="https://qo100dx.club/">QO-100 DX Club</a> logo on his profile page, along with some other links. That started me down the rabbit hole. üêáüõ∞Ô∏è</p>
<p>Briefly, and there‚Äôs more details <a href="https://amsat-uk.org/satellites/geo/eshail-2/">here</a>, QO-100 is the name given to a geostationary satellite that sits above Africa and has amateur radio transponders. This means it‚Äôs always in the same place, and can be used by amateur radio license holders to make contacts across its coverage. Being in such a high orbit means it has a huge area of coverage, so you can contact anyone in this area and talk to them for hours without the worry of propagation changing and losing contact.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="coverage.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="QO-100 Coverage"><img src="coverage.png" class="img-fluid figure-img" alt="QO-100 Coverage"></a></p>
<figcaption>QO-100 Coverage</figcaption>
</figure>
</div>
<p>Another thing that makes this interesting is that it has both narrow and wide bands. This allows for voice, Morse and simpler digital modes on the narrowband and then on the wide band amateur television! So people can broadcast video via the satellite, there‚Äôs even a <a href="https://batc.org.uk/live/oscar100net?mc_cid=871329bb97">weekly net</a> by the British Amateur Television Club (BATC), and they sometimes save them to YouTube. Doing video broadcasting requires a lot more equipment and power, and is maybe a step too far for me.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="AMSAT-QO-100-NB-Transponder-Bandplan-Graph.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="A huge 500 kHz available to amateurs on the QO-100 band plan."><img src="AMSAT-QO-100-NB-Transponder-Bandplan-Graph.png" class="img-fluid figure-img" alt="A huge 500 kHz available to amateurs on the QO-100 band plan."></a></p>
<figcaption>A huge 500 kHz available to amateurs on the QO-100 band plan.</figcaption>
</figure>
</div>
<p>The satellite has been in orbit for about 5 years, so there are a lot of tutorials and guides online on how to get setup, together with people making items that help get connected. The main ones I found useful where <a href="https://dk1mi.radio/qo100-pluto-sdr/">DK1MI‚Äôs</a>, <a href="https://m0aws.co.uk/?cat=167">M0AWS‚Äôs</a>, and <a href="https://www.instructables.com/Satellite-Ground-Station-for-the-QO-100-Eshail-2-G/">G7IYK‚Äôs Instructables page</a>. My setup is basically the same as DK1MI and G7IYK‚Äôs, which I‚Äôll explain shortly.</p>
<p>There seems to be two approaches to getting on the air with QO-100, one is via a SDR that can transmit as well as receive and the other is a transverter that takes you transmitter‚Äôs 2m or 70cm output and ups it to the send frequency. This means you can use a real radio to transmit. You can then either use a SDR for receive or use a downconverter and have your radio be the Rx as well. As I don‚Äôt have a 2m/70cm radio, and the location of my dish is not conducive to using a radio, I went with the SDR option, as that means everything can be housed in a box underneath the dish and all I have to run to it is power and ethernet.</p>
<p>Like most satellites the uplink and the downlink are on different frequencies, in this case it‚Äôs an uplink of 2.4 GHz (think wifi) and downlink is 10 GHz. The downlink is fairly easy, as a LNB (think Sky dish) can receive it and converts it down to 700 MHz range. This is perfectly fine for most SDR receivers to use. Uplink generally requires some amplification as either the upconverter or the SDR only outputs at very low power‚Ä¶but now we‚Äôre getting too into the detail.</p>
<section id="my-plans" class="level2">
<h2 class="anchored" data-anchor-id="my-plans">My Plans</h2>
<p><em>My</em> in a loose sense of the word as it‚Äôs pretty much copying what many others have already done and figured out. I just found it useful to layout so that I could make sure I had all the right parts, particularly on the power side. I also attempted to figure out the power on the transmit side. <a href="https://docs.google.com/presentation/d/e/2PACX-1vTNkueu4v0V2oMeOootdOKTDNyaADicXvgvbXv-nbvk8gYSKnVk1AtFEtICr9DhfnB7kubBdHgr1bUr/pub?start=false&amp;loop=false&amp;delayms=3000">Original version here.</a></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="qo-100-design.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="My QO-100 Schematic"><img src="qo-100-design.png" class="img-fluid figure-img" alt="My QO-100 Schematic"></a></p>
<figcaption>My QO-100 Schematic</figcaption>
</figure>
</div>
<section id="the-receive" class="level3">
<h3 class="anchored" data-anchor-id="the-receive">The Receive</h3>
<p>You‚Äôll want a dish. I mooned over a 1.2m dish for a long time, but the price and size meant it was a no go for me. 80 cm seemed a common size for narrowband, and wideband probably wants something bigger than 1.2 anyway. I measured up where I was planning on putting it and 1.2m was probably too big, maybe I could of squeezed in a 1m but 80 cm should be good enough.</p>
<p>When thinking about what dish size, it‚Äôs important to think about the location of it. The satellite is to the south from the UK, near enough the same direction as sky dishes ‚Äì a good guide if you or neighbours have on. You can get dish pointing info from the <a href="https://eshail.batc.org.uk/point/">BATC on their website</a>. So you can drag a pin around to place it exactly where you want it.</p>
<p>I originally wanted it on a south westerly wall but it probably would‚Äôve ended up being mounted at 90¬∞ and that would mean being at least 40cm off the wall ‚Äì perfect for a gust of wind to rip it off! However, I‚Äôm lucky enough to have a south-ish facing wall at the back of my house and so it was okay to find another location. I also bought a U shaped mount, so it could sit flush to the wall, which helps with wind loading and keeping it out the way.</p>
<p>The signal is focused onto a LNB (low-noise block downconverter). According to the internet, the Bullseye LNB is the ‚Äúbest‚Äù one. It‚Äôs fairly cheap, ~¬£30, and stable. In order for it to recieve the signal, a voltage has to be applied for polarisation of the signal. In our case, for the narrowband we need it to be vertically polarised and so applying 12V is what‚Äôs needed. This is done with a handy biased tee, that allows you to inject the voltage to the feed from the LNB, but blocks the DC voltage from continuing on to your recevier. I used satellite cable, the typical f type connector, 75 ohm stuff.</p>
<p>That‚Äôs it! The signal then continues to your SDR, in my case the Pluto+ SDR. A cheap SDR like a RTL-SDR or NooElec will do the job. As I said, a(nother) downconverter is an option but not the route I took.</p>
</section>
<section id="pluto-sdr" class="level3">
<h3 class="anchored" data-anchor-id="pluto-sdr">Pluto+ SDR</h3>
<p>Now‚Äôs a good time to talk about this SDR. First came the <a href="https://wiki.analog.com/university/tools/pluto">Adalm-Pluto</a> by Analog devices. A great SDR which has transmit and recieve and ideal for students and amateurs alike. Many people use this SDR with great success and many have modified it themselves to improve it.</p>
<p>The Pluto+ is an upgraded version of Analog device‚Äôs SDR with various improvements available out of the box. Most noticeable are the metal enclosure, the four SMA connections, for two sets of recevie and transmit, a gigabit ethernet connection, a microSD slot, a external clock input on the PCB, and 0.5 ppm TCXO. Probably there are other tweaks too but not things that stood out to me. To me the biggest selling point was the network port and the relative ease at which you can add a GPSDO for stability (not something I had as part of the original plan but a nice <a href="https://dk1mi.radio/qo100-gpsdo/">blog post from DK1MI</a> again shows how easy it is to add).</p>
<p>In my hours of searching and reading forums I recall coming across something like ‚Äúif you‚Äôre building on from scratch go for the Pluto+‚Äù, and so I did. I bought mine from Aliexpress.</p>
<p><a href="https://www.youtube.com/watch?v=higdhj46aUk">Tech Minds has a nice video</a> on it if you want to see more.</p>
</section>
<section id="the-transmit" class="level3">
<h3 class="anchored" data-anchor-id="the-transmit">The Transmit</h3>
<p>The Pluto+ SDR has a transmit and can output 2.4 GHz in the region of up to 4 mW, which is great but also not going to get you a contact, and so some amplification is needed. These days it‚Äôs pretty much a standard design to use the Analog Devices CN-0417 amplifier straight out of the SDR and then another one to take it to up to 20 W. It seems like you really only need 10 W with a 80 cm dish to get a strong signal. In fact, if you transmit with too much power you hear a two-tone siren going off called LEILA warning you to turn down. A popular amp is the SG Labs 20W model from Bulgaria, and so that‚Äôs what I picked. 20W seems useful to overcome and losses in connectors and cables.</p>
<p>Which brings to me to cables. At 2.4 GHz, losses are high on regular coax (RG58/213) and so you really want some fancier stuff. I went for LMR-400-UF (UF for ultra-flexible to get round corners). It has many layers and is quite something to hold after only ever using RG58 on HF. You also want to keep it as short as possible and so the amplifier needs to be near your dish.</p>
<p>Finally, the actual feed to the dish. There seems to be two or three styles people use, a ‚ÄúPOTY‚Äù or a helix seem most common. I felt like there were a lot of pieces to this build and so I wasn‚Äôt wanting to build everything myself, I decided to buy an Ice Cone feed from <a href="https://nolle.engineering/en/ice-cone-feed/">nolle engineering</a> in Germany. This is a helix design, housed in a 3D printed case that looks like a huge ice cream cone. It‚Äôs designed very well and sits on top of the LNB (they even sell adapters for the most common LNBs people use with QO-100).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="icecone.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="It‚Äôs a three scoop minimum."><img src="icecone.jpeg" class="img-fluid figure-img" alt="It‚Äôs a three scoop minimum."></a></p>
<figcaption>It‚Äôs a three scoop minimum.</figcaption>
</figure>
</div>
</section>
<section id="power" class="level3">
<h3 class="anchored" data-anchor-id="power">Power</h3>
<p>All these bits and bobs need power, and at different voltages:</p>
<ul>
<li>The biased tee needs 12 V</li>
<li>The Pluto+ SDR and CN-0417 need 5 V</li>
<li>SG Labs PA needs 24-28 V</li>
</ul>
<p>Again, as a common build, people have found a common solution, particularly as a lot of people power it from their shack power supply, and everything hangs off a 12 V supply. There are two DC converters, one to 5V with USB sockets for those users and then one that converts to 28V (although is adjustable) from 12V.</p>
<p>For me, and the location of my shack and the dish meant I needed an external power supply. Luckily, I have an external power socket within 5m or so of the dish so I just needed to convert it to 12V. In the end I decided upon a Meanwell power brick ‚Äì think laptop brick ‚Äì which gives up to 5A on 12V, this should be more than enough. I also bought a great long kettle lead to plug it in. Going for the brick meant it could sit in my waterproof enclosure with everything else. Plus the 5V DC converter had a pin socket, so I could use the pin from the power supply to power it and then the input pins, which are in parallel, for transferring that 12V on to the other users.</p>
<p>For the enclosure I found <a href="https://www.screwfix.com/p/hylec-ip65-weatherproof-outdoor-enclosure-250-x-150-x-350mm/7766g">this</a> on screwfix. It‚Äôs just about big enough. The mounting isn‚Äôt great but works.</p>
</section>
<section id="cost" class="level3">
<h3 class="anchored" data-anchor-id="cost">Cost</h3>
<p>It‚Äôs quite pricey to do this build. Part of me doesn‚Äôt want to list it all here and add it up üòÖ However, as I didn‚Äôt have a 70cm/2m radio this route was probably going to be the cheapest. I could‚Äôve scounged more on items, or tried to find more things used, but insted I bought the parts over about 6 weeks, then when it was only one ¬£100-150 thing a week it didn‚Äôt feel that bad! Ballpark is probably ¬£600-700. I also ended up buying some tools and general items that I didn‚Äôt have, but will be useful for other projects.</p>
</section>
<section id="and-finally" class="level3">
<h3 class="anchored" data-anchor-id="and-finally">and finally‚Ä¶</h3>
<p>Have I built it yet? I have, (and maybe why I struggle with tense in this post!) it still has a couple of issues but I‚Äôve made some QSOs. More details in the next part.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="qo100-1st-receive.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Inpromptu dish mounting"><img src="qo100-1st-receive.jpg" class="img-fluid figure-img" alt="Inpromptu dish mounting"></a></p>
<figcaption>Inpromptu dish mounting</figcaption>
</figure>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/gm5alx\.uk");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/alexjj/gm5alx/blob/main/posts/2023/qo-100-build-part-1-the-design/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div></div></footer><script src="https://tinylytics.app/embed/SfVSskz468248y-YF1aQ.js" defer=""></script>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","openEffect":"zoom","descPosition":"bottom","loop":false,"selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>